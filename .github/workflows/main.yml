on: [workflow_dispatch, push]

permissions:
  contents: write

jobs:
  update-architecture:
    runs-on: ubuntu-latest
    name: Update architecture diagram
    steps:
      - name: Debugging Host Availability
        run: |
          curl -k -I https://infragenie.eu || exit 1
      - name: Invoke infragenie to commit the diagram
        uses: Rikenunes8/infragenie-ghaction@master
        with:
          access_token: ${{ secrets.GITHUB_TOKEN }}
          host: 'https://infragenie.eu'
          branch: test-action
